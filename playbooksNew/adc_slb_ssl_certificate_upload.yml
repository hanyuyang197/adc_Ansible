---
- name: 上传SSL证书文件
  hosts: localhost
  gather_facts: false
  collections:
    - horizon.modules
  
  tasks:
    - name: 登录ADC设备获取认证密钥
      hadc_slb_login:
        ip: "{{ adc_ip }}"
        username: "{{ adc_username }}"
        password: "{{ adc_password }}"
      register: login_result
      
    - name: 上传SSL证书文件
      hadc_slb_ssl_certificate:
        ip: "{{ adc_ip }}"
        authkey: "{{ login_result.authkey }}"
        action: upload
        file_path: "{{ certificate_file_path }}"
        cert_name: "{{ certificate_name | default(omit) }}"
        # API action: slb.ssl.certificate.upload
      register: upload_result
      
    - name: 显示上传结果
      debug:
        msg: "SSL证书上传结果: {{ upload_result }}"
      
    - name: 登出ADC设备
      hadc_slb_logout:
        ip: "{{ adc_ip }}"
        authkey: "{{ login_result.authkey }}"
        
  vars:
    adc_ip: "192.168.70.73"
    adc_username: "admin"
    adc_password: "admin"
    certificate_file_path: "/path/to/your/certificate.crt"
    certificate_name: "my_certificate"

# 使用说明:
# 1. 修改adc_ip、adc_username、adc_password为实际的ADC设备信息
# 2. 设置certificate_file_path为要上传的证书文件路径
# 3. certificate_name为可选参数，用于指定证书在ADC中的名称
# 4. 运行命令: ansible-playbook playbooksNew/adc_slb_ssl_certificate_upload.yml